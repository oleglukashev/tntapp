<md-tab>
  <md-tab-label>
    <div class='text-center l-h uppercase' translate='reserv'></div>
  </md-tab-label>
  <md-tab-body>
    <form ng-submit='reserv.submitReservationForm()'>
      <div class='md-content-submit b-t' flex>
        <div class='wrapper' layout='column' layout-align='space-around center'>
          <div class='w-xl'>
            <md-input-container class='md-block'>
              <label translate='date'></label>
              <md-datepicker ng-model='reserv.current_part.date'
                             ng-change='reserv.changeDatePostProcess()'></md-datepicker>
            </md-input-container>
            <md-input-container class='md-block'>
              <label translate='number_of_guests'></label>
              <md-icon><i class='mdi mdi-account-multiple i-20' /></md-icon>
              <input type='number'
                     ng-model='reserv.current_part.number_of_persons'
                     ng-change='reserv.changeNumberOfPersonsPostProcess()'
                     ng-required='false' />
            </md-input-container>
            <md-input-container class='md-block'>
              <label translate='product'></label>
              <md-icon><i class='mdi mdi-silverware-variant i-20' /></md-icon>
              <md-select ng-change='reserv.changeProductPostProcess()'
                         ng-model='reserv.current_part.product'>
                <md-option ng-value='item.id' ng-repeat='item in reserv.products'>
                  {{ item.name }}
                </md-option>
              </md-select>
              <div class='md-errors-spacer'></div>
            </md-input-container>
            <md-input-container class='md-block'>
              <label translate='time'></label>
              <md-icon><i class='mdi mdi-clock i-20' /></md-icon>
              <md-select ng-change='reserv.changeTimePostProcess()'
                         ng-disabled='!reserv.canLoadTime()'
                         ng-model='reserv.current_part.time'>
                <md-option ng-value='item.time'
                           ng-class="{ 'red-300': reserv.timeIsDisabled(item) }"
                           ng-repeat='item in reserv.openedTimeRangePeriod()'>{{ item.time }}</md-option>
              </md-select>
              <div ng-show='reserv.disabledTimes().length'>
                <i class="mdi mdi-checkbox-blank-circle i-16 red-color-200"></i>
                â€“ <translate>reservation.not_enough_seats</translate>
              </div>
              <div class='md-errors-spacer'>
              </div>
            </md-input-container>
            <md-input-container class='md-block'>
              <label translate='table'></label>
              <md-icon><i class='mdi mdi-border-horizontal i-20' /></md-icon>
              <md-select multiple
                         ng-change='reserv.changeFilterPostProcess()'
                         ng-disabled='!reserv.current_part.time'
                         ng-model='reserv.current_part.table_ids'>
                <md-optgroup ng-repeat='zone in reserv.zones' label='{{ zone.name }}'>
                  <md-option ng-value='table_id' ng-repeat='table_id in zone.table_ids'
                             ng-disabled='reserv.isDisabledTableByTableId(table_id)'>
                    {{ 'table' | translate }} {{ reserv.Reservation.getTableNumberByTableId(reserv.tables, table_id) }} - {{ reserv.Reservation.getPersonCountByTableId(reserv.tables, table_id) }} <trasnalte class='lowercase'>persons</trasnalte>
                  </md-option>
                </md-optgroup>
              </md-select>
              <div class='md-errors-spacer'></div>
            </md-input-container>
            <md-input-container class='md-block'>
              <label translate='comment'></label>
              <md-icon><i class='mdi mdi-message-text i-20' /></md-icon>
              <textarea ng-model='reserv.current_part.notes' ng-required='false'></textarea>
            </md-input-container>
            <div ng-show='reserv.reservation.reservation_pdf'>
              <label class='btn btn-default block m-b-xs no-shadow text-success text-left'
                     ng-click='reserv.loadPDF();'>
                <span class='m-r-sm'>
                  <i class='mdi mdi-pdf'></i>
                  <translate>reservation.pdf</translate>
                </span>
                <div class='pull-right'>
                  <i class='mdi mdi-delete' ng-click='reserv.removePdf($event);'></i>
                </div>
              </label>
            </div>
            <button type='button'
                    md-ink-ripple
                    class='md-btn md-flat m-b m-t btn-fw text-success m-l-6'
                    ngf-select=''
                    ngf-drop=''
                    ngf-pattern="'.pdf'"
                    accept='application/pdf'
                    ng-model='reserv.reservation.reservation_pdf'
                    translate='reservation.pdf_upload'></button>
            <div class='md-form-group no-padder m-b-sm'>
              <md-checkbox ng-model='reserv.reservation.is_group'
                           ng-change='reserv.changeIsGroupPostProcess()'
                           aria-label='{{ "reservation.group" | translate }}?'>
                {{ 'reservation.group' | translate }}?
              </md-checkbox>
            </div>
            <div ng-show='reserv.reservation.is_group'>
              <label ng-repeat='part in reserv.reservation.reservation_parts'
                     class='btn btn-default block m-b-xs no-shadow text-success text-left'
                     ng-click='reserv.setCurrentPart(part);'
                     ng-model='reserv.current_part'
                     btn-radio='part'>
                <span class='m-r-sm'>
                  <i class='mdi mdi-clock'></i>
                  {{ reserv.moment(part.date).format('DD.MM.YY') }} {{ part.time }}
                </span>
                <span class='m-r-sm' ng-show='part.number_of_persons'>
                  <i class='mdi mdi-account-multiple'></i>
                  <small class='font-thin m-r-xs'>{{ part.number_of_persons }}x</small>
                </span>
                <span class='m-r-sm' ng-show='part.product'>
                  <i class='mdi mdi-silverware-variant'></i>
                  <small class='font-thin'>{{ reserv.Reservation.getProductNameByProductId(reserv.products, part.product) }}</small>
                </span>
                <span class='m-r-sm' ng-show='part.tables.length'>
                  <img class='table_icon' src='public/images/table.svg' />
                  <small class='font-thin' ng-bind='reserv.Table.getTableNumbersByTableIds(reserv.tables, part.tables).join(", ")'></small>
                </span>
                <div class='pull-right'
                     ng-show='reserv.reservation.reservation_parts.length > 1'>
                  <i class='mdi mdi-delete' ng-click='reserv.removePart($event, $index);'></i>
                </div>
              </label>

              <label ng-click='reserv.addPart()'
                     class='btn btn-sm font-bold m-xs text-success no-shadow no-border'
                     translate='reservation.add_activity'></label>
            </div>
          </div>
        </div>
        <div class='wrapper red-300 layout-align-space-around-center layout-column'
             ng-show='reserv.errors.length'>
          <div class='w-xl'>
            <div ng-repeat='error in reserv.errors'>
              {{ error }}
            </div>
          </div>
        </div>
        <button type='submit'
                class='btn btn-lg btn-success w-full no-top-radius md-content-button'
                ng-class="{ 'disabled': reserv.is_submitting }">
          <translate>save</translate>
        </button>
      </div>
    </form>
  </md-tab-body>
</md-tab>