<div ng-show='agenda.is_loaded' class='col-lg-8 col-md-8 col-sm-8'>

  <div ng-init='showRightMenu = true; view = agenda.reservations_view' data-ng-include=" 'page_filter.view.html' " ng-controller='PageFilterCtrl as page_filter'></div>

  <button ng-click='agenda.openReservation()' md-ink-ripple class='panel-add-button md-btn md-fab m-b'>
    <i class='mdi mdi-plus i-24'></i>
  </button>

  <accordion class='agenda' close-others='false'>
    <accordion-group ng-repeat='zone in agenda.zones' is-open='agenda.opened[$index]'>
      <accordion-heading>
        <div class='clearfix' ng-click='agenda.scrollToNow($index)'>
          <div class='pull-left'>
            {{ zone.name }}
            <i class='mdi mdi-chevron-down i-24' ng-if='!agenda.opened[$index]'></i>
            <i class='mdi mdi-chevron-up i-24' ng-if='agenda.opened[$index]'></i>
          </div>
        </div>
      </accordion-heading>

      <div grid-data
           grid-options='agenda.getTableOptions(zone)'
           grid-actions='agenda.gridActions'
           ng-show='agenda.reservations_view == "list"'>
        <table class='table m-b-none'>
          <thead>
            <tr>
                <th>Aanwezig</th>
                <th sortable='time' class='sortable'>
                  Tijd
                  <span class='arrow ascent'></span>
                  <span class='arrow descent'></span>
                </th>
                <th sortable='product_name' class='sortable'>
                  Product
                  <span class='arrow ascent'></span>
                  <span class='arrow descent'></span>
                </th>
                <th sortable='name' class='sortable'>
                  Naam
                  <span class='arrow ascent'></span>
                  <span class='arrow descent'></span>
                </th>
                <th sortable='number_of_persons' class='sortable'>
                  Personen
                  <span class='arrow ascent'></span>
                  <span class='arrow descent'></span>
                </th>
                <th sortable='tables' class='sortable'>
                  Tafel
                  <span class='arrow ascent'></span>
                  <span class='arrow descent'></span>
                </th>
                <th class='text-right'>Opmerking</th>
                <th></th>
            </tr>
          </thead>
          <tbody>
            <tr data-ng-include=" 'agenda.item.view.html' "
                ng-click='user.openCustomerMenu(item.customer_id, part.id)'
                ng-class='{"active": agenda.active_part == item.id,
                           "cancelled": item.reservation.status == "cancelled"}'
                ng-controller='UserMenuCtrl as user'
                ng-repeat='(index, item) in data = filtered | startFrom:(paginationOptions.currentPage-1)*paginationOptions.itemsPerPage | limitTo:paginationOptions.itemsPerPage track by $index'
                ng-mouseup='agenda.active_part = item.id'
                ng-init='controller = agenda;'></tr>
          </tbody>
        </table>
      </div>

      <div class='tables_wrapper' ng-show='agenda.reservations_view == "calendar"' ng-if='agenda.tables_by_zone[zone.id].length'>
        <div ng-repeat='(tableIndex, table) in agenda.tables_by_zone[zone.id] | orderBy:"position"'>
          <div class='table_item_number pull-left m-t-sm' ng-style='{ top: tableIndex * agenda.reservation_height }'>
            {{ table.table_number }}
          </div>
        </div>
      </div>

      <div class='calendar_wrapper' ng-show='agenda.reservations_view == "calendar"' data-zone-id='{{ zone.id }}'>

        <div class='scroll-wrapper'>
          <div class='hours-timeline' ng-if='agenda.tables_by_zone[zone.id].length'>
            <div class='hour' ng-repeat='hour in agenda.hours'>
              {{ hour }}:00
            </div>
          </div>

          <div class='timeline-wrapper' ng-if='agenda.tables_by_zone[zone.id].length'>

            <div class='now' ng-style='agenda.nowLineStyle(zone.id)' ng-if='agenda.is_today'></div>

            <ul class='tables md-list no-padder no-margin'>
              <li class='table_item md-list-item no-padder no-margin z-index1'
                  ng-repeat='(tableIndex, table) in agenda.tables_by_zone[zone.id] | orderBy:"position"'>

                <div class='hours-wrapper'>
                  <div class='hour' ng-repeat='hour in agenda.hours'>
                    <div class='quarter'
                         data-hour='{{ hour }}'
                         data-quarter='{{ quarter }}'
                         data-zone-id='{{ zone.id }}'
                         ng-repeat='quarter in [0,1,2,3]'
                         ui-on-drop='agenda.onDrop(table.id, tableIndex, hour, quarter, $data)'
                         ng-click='agenda.openQuickReservation(table.id, table.table_number, hour, quarter)'
                         ng-class='agenda.getQuarterClass(hour, quarter)'
                         drop-channel='move,resize'></div>
                  </div>

                  <div class='reservation'
                       ng-repeat='(partId, part) in agenda.partsByTable[table.id]'
                       ui-on-drop=''
                       drop-channel='resize'
                       ui-draggable='true'
                       drag='partId'
                       ng-style='agenda.reservationBlockStyle(tableIndex, part)'
                       on-drop-failure='agenda.dragEnd()'
                       ng-class='agenda.draggable_class'
                       data-product-id='{{ part.product_id }}'
                       data-id='{{ partId }}'
                       drag-channel='move'>
                    <i class='mdi i-20'
                       ng-class='agenda.ReservationStatus.getIcon(part.reservation)'
                       ng-click='agenda.setPresent(part.reservation)'
                       title='{{ agenda.ReservationStatus.getStatus(part.reservation) | capitalize }}'
                    ></i>
                    <a ng-click='user.openCustomerMenu(part.customer.id, partId)' ng-controller='UserMenuCtrl as user'>
                      {{ part.number_of_persons }}
                      {{ agenda.products[part.product_id] }}
                      <strong>
                        {{ part.customer.last_name }}
                        {{ part.customer.first_name }}
                      </strong>
                    </a>
                    <div class='resizer' ui-draggable='true' drag-channel='resize'></div>
                  </div>


                </div>
              </li>
            </ul>
          </div>
        </div>
      </div>

    </accordion-group>
  </accordion>
</div>

<div data-ng-include=" 'user_menu.view.html' " ng-controller='UserMenuCtrl as user'></div>