<div class='agenda-content'>
  <ng-include src="'agenda.widget.html'"></ng-include>

  <div class='col-lg-8 col-md-8' ng-show='agenda.is_loaded'>
    <div class='page_filter m-b-md clearfix'>
      <div class='pull-left m-r-xs'
           ng-init='controller = agenda'
           data-ng-include=" 'page_filter.print.view.html' "></div>
      <div class='pull-left m-r-xs'
           ng-init='controller = agenda'
           data-ng-include=" 'page_filter.date.view.html' "></div>
      <div class='pull-left'
           ng-init='controller = agenda'
           data-ng-include=" 'page_filter.settings.view.html' "></div>
      <div class='pull-left m-r-xs'
           ng-init='controller = agenda'
           data-ng-include=" 'page_filter.filter.view.html' "></div>
      <div class='page_sort pull-left'
           ng-init='controller = agenda'
           data-ng-include=" 'page_filter.sort.view.html' "></div>
      <div class='pull-right'
           ng-init='controller = agenda'
           data-ng-include=" 'page_filter.change_view.view.html' "></div>
    </div>

    <button ng-click='agenda.openReservation()' md-ink-ripple class='panel-add-button md-btn md-fab m-b'>
      <md-tooltip>{{ 'new_reservation' | translate }}?</md-tooltip>
      <i class='mdi mdi-plus i-24'></i>
    </button>

    <div class='panel' ng-show='agenda.view_type == "list"'>
      <div class='panel-heading' translate='reservations'></div>
      <div class='panel-body no-padder'>
        <div ng-hide='agenda.data.length'
             class='empty_reservations'
             translate='make_first_reservation'>
        </div>

        <table class='table m-b-none' ng-show='agenda.data.length'>
          <thead>
            <tr>
                <th width='8%' translate='present'></th>
                <th width='10%' translate='time'></th>
                <th width='12%' translate='product'></th>
                <th width='12%' translate='name'></th>
                <th width='10%' translate='persons'></th>
                <th width='10%' translate='table'></th>
                <th translate='note'></th>
                <th width='8%'></th>
            </tr>
          </thead>
          <tbody>
            <tr data-ng-include=" 'agenda.item.view.html' "
                ng-click='agenda.openCustomerMenu(item.customer_id, item.id)'
                ng-class='{"active": agenda.active_part == item.id,
                           "cancelled": item.reservation.status == "cancelled",
                           "hide-icon": item.reservation.id === agenda_data[$index - 1].reservation.id}'
                ng-repeat='item in agenda_data = agenda.data'
                ng-mouseup='agenda.active_part = item.id'
                ng-init='controller = agenda;'>
                </tr>
          </tbody>
        </table>
      </div>
    </div>

    <accordion class='agenda'
               close-others='false'
               ng-show='agenda.view_type == "calendar"'>
      <accordion-group ng-repeat='(zoneId, zone) in agenda.zones'
                       is-open='agenda.opened[$index]'
                       ng-if='agenda.zones'>
        <accordion-heading>
          <div class='clearfix' ng-click='agenda.scrollToNow($index)'>
            <div class='pull-left'>
              {{ zone.name }}
              <i class='mdi mdi-chevron-down i-24' ng-show='!agenda.opened[$index]'></i>
              <i class='mdi mdi-chevron-up i-24' ng-show='agenda.opened[$index]'></i>
            </div>
          </div>
        </accordion-heading>

        <div ng-if='agenda.opened[$index]'>
          <div class='tables_wrapper'>
            <div ng-repeat='(tableIndex, tableId) in zone.table_ids | orderBy:"position"'>
              <div class='table_item_number pull-left m-t-sm'
                   ng-style='{ top: tableIndex * agenda.reservation_height }'
                   ng-bind='agenda.tables[tableId].table_number'></div>
            </div>
          </div>

          <div class='calendar_wrapper' data-zone-id='{{ zone.id }}'>
            <div class='scroll-wrapper'>
              <div class='hours-timeline' ng-show='zone.table_ids.length'>
                <div class='hour' ng-repeat='hour in agenda.hours'>
                  {{ hour }}:00
                </div>
              </div>
              <div class='timeline-wrapper' ng-show='zone.table_ids.length'>
                <div class='now' ng-style='agenda.nowLineStyle(zone.id)' ng-show='agenda.is_today'></div>
                <ul class='tables md-list no-padder no-margin'>
                  <li class='table_item md-list-item no-padder no-margin z-index1'
                      ng-repeat='(tableIndex, tableId) in zone.table_ids | orderBy:"position"'
                      ng-if='agenda.tables[tableId]'>
                    <div class='hours-wrapper'>
                      <div class='hour' ng-repeat='hour in agenda.hours'>
                        <div class='quarter'
                             data-hour='{{ hour }}'
                             data-quarter='{{ quarter }}'
                             data-zone-id='{{ zone.id }}'
                             ng-repeat='quarter in [0,1,2,3]'
                             ui-on-drop='agenda.onDrop(tableId, tableIndex, hour, quarter, $data)'
                             ng-click='agenda.openWalkIn(tableId, agenda.tables[tableId].table_number, hour, quarter)'
                             ng-class='{ closed: agenda.isClosedTime(hour, quarter, zone.id) }'
                             ng-mouseenter="hover=true"
                             ng-mouseleave="hover=false"
                             drop-channel='move,resize'><div></div></div>
                      </div>
                      <div class='reservation'
                           ng-repeat='item in agenda.graph_data[tableId]'
                           ng-if='agenda.graph_data[tableId]'
                           ui-on-drop=''
                           drop-channel='resize'
                           ui-draggable='true'
                           drag='[item.id, tableId]'
                           ng-style='agenda.reservationBlockStyle(tableIndex, tableId, item)'
                           on-drop-failure='agenda.dragEnd()'
                           ng-class='agenda.draggable_class'
                           data-product-id='{{ item.product.id }}'
                           data-id='{{ item.id }}'
                           drag-channel='move'>
                        <div class='reservation_wrapper'>
                          <span
                             data-ng-include=" 'reservation_status_menu.view.html' "
                             ng-init='controller = agenda; agendaIcon = true'
                          ></span>
                          <a ng-click='agenda.openCustomerMenu(item.customer.id, item.id)'>
                            {{ item.number_of_persons }}
                            {{ item.product_name }}
                            <strong ng-bind='item.name'></strong>
                          </a>
                          <div class='resizer' ui-draggable='true' drag-channel='resize'></div>
                        </div>
                      </div>

                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </accordion-group>
    </accordion>
  </div>

  <div class='agenda-timeranges col-lg-3 col-md-3' ng-show='agenda.time_ranges_is_loaded'>
    <div data-ng-include=" 'agenda_charts.view.html' " ng-controller='AgendaChartsCtrl as agenda_charts'></div>

    <div class='panel'>
      <div class='panel-heading' translate='time_ranges'></div>
      <div class='panel-body no-padder'>
        <table class='table no-margin'>
          <thead>
            <th translate='type'></th>
            <th translate='value'></th>
            <th translate='time'></th>
          </thead>
          <tbody>
            <tr ng-repeat='time_range in agenda.time_ranges'>
              <td class='v-middle'>
                <span ng-if='time_range.type !== "zone" && time_range.type !== "product"'>
                  {{ time_range.type }}
                </span>
                <span ng-if='time_range.type == "zone"'>{{ agenda.getZoneNameByRange(time_range) }}</span>
                <span ng-if='time_range.type == "product"'>{{ agenda.getProductsName(time_range) }}</span>
              </td>
              <td ng-if='["open", "zone", "product", "multiproduct"].includes(time_range.type)'
                  class='v-middle'>{{ time_range.value ? 'opened' : 'closed' | translate }}</td>
              <td ng-if='time_range.type == "overboeken"'
                  class='v-middle'>{{ time_range.value ? 'overbooking' : 'not_overbooking' | translate }}</td>
              <td class='v-middle'>
                <span ng-if='!time_range.whole_day'>
                  {{ time_range.start_time }} - {{ time_range.end_time }}
                </span>
                <span ng-if='time_range.whole_day' translate='whole_day'></span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<div data-ng-include=" 'reservation_print.view.html' " ng-init='controller = agenda'></div>
